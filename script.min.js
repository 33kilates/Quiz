function trackEvent(n, e = {}) { if (console.log(`üìä Evento: ${n}`, e), "function" == typeof gtag && gtag("event", n, e), "function" == typeof fbq && fbq("trackCustom", n, e)); } function genEventId() { return crypto?.randomUUID && crypto.randomUUID() || String(Date.now()) + "-" + Math.random() } function getCookie(n) { const e = document.cookie.match(new RegExp("(^|; )" + n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&") + "=([^;]*)")); return e ? decodeURIComponent(e[2]) : null } async function sendCapi(n, e, t = {}) { const o = getCookie("_fbp"), a = getCookie("_fbc"), c = { event_name: n, event_id: e, event_source_url: window.location.href, ...o ? { fbp: o } : {}, ...a ? { fbc: a } : {}, ...t }; try { const n = await fetch("/.netlify/functions/capi", { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(c) }), e = await n.json().catch(() => null); n.ok || console.warn("‚ö†Ô∏è CAPI error:", n.status, e) } catch (n) { console.warn("‚ö†Ô∏è CAPI fetch failed:", n) } } const META_STANDARD_EVENTS = new Set(["PageView", "ViewContent", "Lead", "CompleteRegistration", "AddToCart", "InitiateCheckout", "Purchase"]); function fireMetaEvent(n, e = {}, t = genEventId()) { const o = META_STANDARD_EVENTS.has(n); return "function" == typeof fbq ? (o ? fbq("track", n, e, { eventID: t }) : fbq("trackCustom", n, e, { eventID: t })) : trackEvent(n, e), "function" == typeof gtag && gtag("event", n, e), sendCapi(n, t, {}), t } const model = { activeCount: null, avgTicket: null, basePotential: null }, fmtBRL = n => new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL", maximumFractionDigits: 0 }).format(n); function calcRangesFromPotential(n) { if (!n || n <= 0) return null; return { moderateMin: Math.round(.1 * n), moderateMax: Math.round(.15 * n), heavyMin: Math.round(.3 * n), heavyMax: Math.round(.5 * n) } } function buildMoneyLine() { if (!model.activeCount || !model.avgTicket) return ""; const n = model.activeCount * model.avgTicket; model.basePotential = n; const e = calcRangesFromPotential(n); return e ? `üìå Pela sua resposta, seu potencial de giro mensal fica em torno de <strong>${fmtBRL(n)}</strong>.\n  Se voc√™ estiver 10‚Äì15% abaixo do potencial por ‚Äúperfil errado‚Äù, isso pode ser <strong>${fmtBRL(e.moderateMin)} a ${fmtBRL(e.moderateMax)}</strong> na mesa.` : "" } function buildMoneyLineHeavy() { if (!model.basePotential) return ""; const n = calcRangesFromPotential(model.basePotential); return n ? `‚ö†Ô∏è Em cen√°rios travados, 30‚Äì50% abaixo do potencial vira <strong>${fmtBRL(n.heavyMin)} a ${fmtBRL(n.heavyMax)}</strong> ‚Äúsumindo‚Äù em atraso, mercadoria parada e retrabalho.` : "" } const questions = [{ id: 1, phase: "SITUA√á√ÉO", transition: () => "Leva menos de 3 minutos. Vamos direto ao ponto.", text: "Quantas revendedoras est√£o ATIVAS de verdade hoje (girando mercadoria e acertando com frequ√™ncia)?", options: ["1‚Äì10", "11‚Äì25", "26‚Äì50", "51‚Äì100", "100+"], map: { type: "activeCount", values: [8, 18, 38, 75, 130] } }, { id: 2, phase: "SITUA√á√ÉO", transition: () => "Agora uma pergunta que quase ningu√©m mede ‚Äî e √© onde o lucro se esconde.", text: "Em m√©dia, quanto de mercadoria (em consignado) uma revendedora ativa consegue girar/fechar por m√™s?", options: ["At√© R$ 300", "R$ 300‚Äì700", "R$ 700‚Äì1.200", "R$ 1.200‚Äì2.000", "Acima de R$ 2.000"], map: { type: "avgTicket", values: [250, 500, 950, 1500, 2400] } }, { id: 3, phase: "SITUA√á√ÉO", transition: () => { const n = buildMoneyLine(); return n ? `${n}<br><span class="text-slate-500">√öltima dessa parte. Agora vamos achar o vazamento.</span>` : "√öltima dessa parte. Agora vamos achar o vazamento." }, text: "Como voc√™ decide quanto de mercadoria libera no come√ßo do consignado?", options: ["No feeling (e √†s vezes eu pago caro por isso)", "Pelo papo/urg√™ncia (e j√° quebrei a cara com isso)", "Tenho regra‚Ä¶ mas ainda travo com atrasos e devolu√ß√£o"] }, { id: 4, phase: "PROBLEMA", transition: () => "Grandes opera√ß√µes escalam porque n√£o tratam todo mundo igual: base, pico e lideran√ßa t√™m fun√ß√µes diferentes.", text: "Qual destes cen√°rios acontece com mais frequ√™ncia no seu consignado?", options: ["Atraso no acerto vira rotina", "Mercadoria fica travada/encalhada em algumas m√£os", "Quando d√° problema, recuperar vira desgaste"] }, { id: 5, phase: "PROBLEMA", transition: () => "Isso aqui √© a defini√ß√£o de ‚ÄúEquipe Zumbi‚Äù: gente ocupando espa√ßo e travando seu caixa.", text: "Quantas revendedoras consomem aten√ß√£o/mercadoria, mas n√£o geram giro consistente?", options: ["Muitas ‚Äî e eu empurro pra n√£o ‚Äúperder cadastro‚Äù", "Uma parte relevante ‚Äî trava meu m√™s", "Poucas ‚Äî mas j√° causam preju√≠zo e estresse"] }, { id: 6, phase: "PROBLEMA", transition: () => "Voc√™ j√° est√° na metade. Essa pergunta separa equipe viva de equipe que s√≥ d√° trabalho.", text: "Com que frequ√™ncia algu√©m come√ßa animada e depois trava, desanima ou some?", options: ["O tempo todo ‚Äî eu vivo recome√ßando", "Com frequ√™ncia ‚Äî atrasa meu crescimento", "Menos‚Ä¶ mas ainda me custa caro"] }, { id: 7, phase: "PROBLEMA", transition: () => { const n = buildMoneyLineHeavy(); return n ? `${n}<br><span class="text-slate-500">Agora, vamos ver como isso te prende.</span>` : "Agora, vamos ver como isso te prende." }, text: "Quando a mercadoria retorna, qual situa√ß√£o √© mais comum?", options: ["Volta atrasada e eu preciso correr atr√°s", "Volta parada/encalhada sem justificativa clara", "Volta com desgaste/perda e vira briga pra resolver"] }, { id: 8, phase: "IMPLICA√á√ÉO", transition: () => "A pergunta n√£o √© se d√≥i. √â: quanto isso custa por m√™s sem voc√™ perceber?", text: "Quando a mercadoria trava, o que isso causa primeiro na sua opera√ß√£o?", options: ["Caixa sufoca (menos margem, mais aperto)", "Tempo vai pro ralo (cobran√ßa, confer√™ncia, retrabalho)", "Eu fico com medo e travo o crescimento"] }, { id: 9, phase: "IMPLICA√á√ÉO", transition: () => "Se voc√™ ganha clareza, voc√™ para de virar cobrador(a).", text: "Quanto da sua semana vira ‚Äògerenciar BO‚Äô de revendedora (cobrar, conferir, resolver)?", options: ["Tempo demais ‚Äî parece um segundo trabalho", "Mais do que deveria ‚Äî atrasa o neg√≥cio", "Menos‚Ä¶ mas o peso mental √© constante"] }, { id: 10, phase: "IMPLICA√á√ÉO", transition: () => "Se voc√™ n√£o muda o m√©todo, o padr√£o se repete.", text: "Se nada mudar, qual cen√°rio parece mais prov√°vel nos pr√≥ximos meses?", options: ["Continuar apagando inc√™ndio e perdendo caixa em sil√™ncio", "Crescer com caos (mais gente = mais problema)", "Estagnar por cansa√ßo e medo de liberar consignado"] }, { id: 11, phase: "NECESSIDADE", transition: () => "Agora a virada: m√©todo > sorte. Arquitetura > motiva√ß√£o.", text: "Voc√™ concorda que n√£o d√° pra escalar consignado tratando todo mundo igual?", options: ["Concordo totalmente ‚Äî j√° me custou caro", "Concordo‚Ä¶ mas n√£o sei separar perfis na pr√°tica", "Concordo ‚Äî preciso organizar isso agora"] }, { id: 12, phase: "NECESSIDADE", transition: () => "√öltima. Em seguida eu te mostro exatamente onde est√° o travamento.", text: "O que voc√™ quer resolver primeiro na sua equipe?", options: ["Parar de perder dinheiro com consignado na pessoa errada", "Organizar o mix de perfis pra ter caixa previs√≠vel", "Ter clareza total antes de colocar mais mercadoria pra rua"] }], TOTAL_QUESTIONS = questions.length; let currentQuestionIndex = 0, answers = [], selectedOptionIndex = null, didStart = !1, didComplete = !1; const introScreen = document.getElementById("intro-screen"), quizContainer = document.getElementById("quiz-container"), questionContent = document.getElementById("question-content"), progressBar = document.getElementById("progress-bar"), progressText = document.getElementById("progress-text"), nextBtn = document.getElementById("next-btn"), loadingScreen = document.getElementById("loading-screen"), resultScreen = document.getElementById("result-screen"); function startQuiz() { didStart || (didStart = !0, fireMetaEvent("StartQuiz", { source: "intro" })), gsap.to(introScreen, { duration: .5, opacity: 0, y: -20, onComplete: () => { introScreen.classList.add("hidden"), quizContainer.classList.remove("hidden"), gsap.fromTo(quizContainer, { opacity: 0, y: 20 }, { duration: .5, opacity: 1, y: 0 }), renderQuestion(currentQuestionIndex) } }) } function getTransitionText(n) { if (!n.transition) return ""; try { return "function" == typeof n.transition ? n.transition() : String(n.transition) } catch { return "" } } function renderQuestion(n) { const e = questions[n]; selectedOptionIndex = null; const t = Math.round(n / TOTAL_QUESTIONS * 100); progressBar.style.width = `${t}%`, progressText.innerText = `${t}%`, fireMetaEvent("ViewQuestion", { question_number: n + 1, phase: e.phase, question_id: e.id }); const o = e.options.map(((n, e) => `\n        <div class="option-card border-2 border-slate-100 rounded-xl p-4 flex items-center gap-4 cursor-pointer group hover:border-accent/50 bg-white"\n             onclick="selectOption(${e}, this)">\n          <div class="option-circle w-6 h-6 rounded-full border-2 border-slate-300 flex items-center justify-center shrink-0">\n            <div class="option-check w-3 h-3 bg-white rounded-full opacity-0 transform scale-0 transition-all duration-200"></div>\n          </div>\n          <span class="text-slate-700 font-medium group-hover:text-primary transition-colors text-lg">${n}</span>\n        </div>\n      `)).join(""), a = getTransitionText(e); questionContent.innerHTML = `\n    <div class="animate-content">\n      <span class="text-xs font-bold text-accent tracking-widest uppercase mb-2 block">${e.phase}</span>\n\n      ${a ? `<p class="text-sm text-slate-500 mb-3 italic">${a}</p>` : ""}\n\n      <h3 class="text-xl md:text-2xl font-bold text-slate-800 mb-6 leading-tight">${e.text}</h3>\n      <div class="space-y-3 flex flex-col">\n        ${o}\n      </div>\n    </div>\n  `, gsap.fromTo(".animate-content", { opacity: 0, y: 20 }, { duration: .4, opacity: 1, y: 0, ease: "power2.out" }), nextBtn.classList.add("hidden", "opacity-0"), nextBtn.classList.remove("flex") } function applyMappingForQuestion(n, e) { const t = questions.find((e => e.id === n)); t && t.map && ("activeCount" === t.map.type && (model.activeCount = t.map.values[e] ?? model.activeCount), "avgTicket" === t.map.type && (model.avgTicket = t.map.values[e] ?? model.avgTicket), model.activeCount && model.avgTicket && (model.basePotential = model.activeCount * model.avgTicket)) } function selectOption(n, e) { selectedOptionIndex = n, document.querySelectorAll(".option-card").forEach((n => n.classList.remove("selected", "border-accent", "bg-accent/5"))), e.classList.add("selected"), fireMetaEvent("SelectOption", { question_number: currentQuestionIndex + 1, question_id: questions[currentQuestionIndex].id, option_index: n }), nextBtn.classList.contains("hidden") && (nextBtn.classList.remove("hidden"), nextBtn.classList.add("flex"), gsap.to(nextBtn, { duration: .3, opacity: 1, y: 0, ease: "back.out(1.7)" })) } function nextQuestion() { if (null === selectedOptionIndex) return void console.warn("‚ö†Ô∏è Nenhuma op√ß√£o selecionada."); const n = questions[currentQuestionIndex]; answers.push({ questionId: n.id, selectedOptionIndex: selectedOptionIndex, phase: n.phase }), applyMappingForQuestion(n.id, selectedOptionIndex), gsap.to(".animate-content", { duration: .3, opacity: 0, x: -20, onComplete: () => { currentQuestionIndex++, currentQuestionIndex < questions.length ? renderQuestion(currentQuestionIndex) : finishQuiz() } }) } function finishQuiz() { didComplete || (didComplete = !0, fireMetaEvent("QuizComplete", { total_answers: answers.length })), gsap.to(quizContainer, { duration: .5, opacity: 0, scale: .95, onComplete: () => { quizContainer.classList.add("hidden"), loadingScreen.classList.remove("hidden"), setTimeout((() => { loadingScreen.classList.add("hidden"), resultScreen.classList.remove("hidden"), gsap.fromTo(resultScreen, { opacity: 0, scale: .9 }, { duration: .6, opacity: 1, scale: 1, ease: "back.out(1.2)" }) }), 2500) } }) } function redirect() { fireMetaEvent("ClickCTA", { destination: "Landing Page" }), window.location.href = "#landing-page" } const PASSTHROUGH_KEYS = ["utm_source", "utm_medium", "utm_campaign", "utm_content", "utm_term", "fbclid", "gclid", "ttclid", "wbraid", "gbraid"]; function buildPassthroughURL(n) { const e = new URLSearchParams(window.location.search), t = new URL(n), o = t.searchParams; PASSTHROUGH_KEYS.forEach((n => { const t = e.get(n); t && o.set(n, t) })); const a = getCookie("_fbp"), c = getCookie("_fbc"); return a && o.set("fbp", a), c && o.set("fbc", c), t.toString() } function goToVSL() { const n = "https://maparevendedoras.netlify.app/", e = genEventId(); "function" == typeof fbq && fbq("track", "Lead", {}, { eventID: e }), sendCapi("Lead", e, {}), window.location.href = buildPassthroughURL(n) } window.startQuiz = startQuiz, window.nextQuestion = nextQuestion, window.selectOption = selectOption, window.redirect = redirect, window.goToVSL = goToVSL;
